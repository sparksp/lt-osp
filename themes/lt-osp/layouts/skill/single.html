{{ define "main" -}}
<article>
    <h1>{{ .Title }}</h1>

    {{- with .Params.tier }}<p><strong>Tier:</strong> {{ . }}</p>{{ end }}

    {{- with .Params.lists }}
    {{- $lists := site.GetPage "/lists" }}
    <p>
        <strong>Lists:</strong>
        {{- $len := len . }}
        {{- range $index, $e := . }}
        {{- if $index }}
        {{- if ge (add $index 1) $len }} and {{ else }}, {{ end }}
        {{- end }}
        {{ $lists.GetPage . | partial "lists/link" }}
        {{- end }}
    </p>
    {{- end }}

    {{- with .Params.prerequisites }}
    <p>
        <strong>Pre-requisite to learn:</strong>
        {{ partial "skill-list" . }}
    </p>
    {{- end }}

    {{- with .Params.requirements }}
    <p>
        <strong>Requirements to use:</strong>
        {{ partial "skill-list" . }}
    </p>
    {{- end }}

    {{ .Content }}

    {{ with (where site.RegularPages ".Params.prerequisites" "intersect" (slice .File.ContentBaseName)).ByParam "tier" -}}
    <aside>
        <h2>Dependent Skills</h2>
        <table class="cell-table">
            <thead>
            <tr>
                <th>Tier</th>
                <th>Skill</th>
            </tr>
            </thead>
            <tbody>
            {{ range . -}}
            <tr>
                <th scope="row">{{ .Params.tier }}</th>
                <td>
                    <a class="cell cell-{{ .Type }}{{ if .Params.restricted }} restricted-cell{{ end }}{{ if .Params.replacement }} replacement-cell{{ end }}"
                       id="{{ .Type }}-{{ .File.UniqueID }}"
                       href="{{ .Permalink }}"
                       title="{{ .Title }}"
                    >
                        {{- .LinkTitle -}}
                    </a>
                </td>
            </tr>
            {{- end }}
            </tbody>
        </table>
    </aside>
    {{- end }}

</article>
{{- end }}